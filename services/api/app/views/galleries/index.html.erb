<%= content_tag :div, class: 'p-4 border-b border-gray-300' do %>
  <%= content_tag :div, class: 'text-xl font-semibold flex items-center justify-between gap-2' do %>
    <%= content_tag :span, class: 'flex items-center' do %>
      <%= icon 'building-storefront' %> Store Manager
    <% end %>

    <%= content_tag :span do %>
      <%= icon 'user-circle', class: 'h-7 w-7 cursor-pointer' %>
    <% end %>
  <% end %>
<% end %>

<%= content_tag :div, class: 'bg-gray-50' do %>
  <%= content_tag :div, class: 'container p-4 mx-auto' do %>
    <%= content_tag :div do %>
      <%= content_tag :div, class: 'flex items-center justify-between mb-8' do %>
        <%= content_tag :div do %>
          <%= content_tag :h1, 'Galleries', class: 'text-3xl font-bold mb-1' %>
          <%= content_tag :p, 'Manage your photography galleries', class: 'text-md text-gray-500' %>
        <% end %>

        <%= link_to new_store_gallery_path, class: 'bg-white flex items-center justify-between px-4 py-2 rounded-md font-medium text-sm border border-gray-400 hover:bg-gray-100' do %>
          <%= icon 'plus' %>
          <%= content_tag :span, 'New Gallery' %>
        <% end %>
      <% end %>
    <% end %>

    <%= content_tag :div do %>
      <%= content_tag :div, class: 'flex justify-between' do %>
        <%= form_with url: store_galleries_path(@store.slug),
          method: :get,
          data: {
            turbo_frame: 'galleries_results',
            turbo_action: 'advance',
            controller: 'submit',
            action: 'input->submit#submit'
          } do |f| %>
          <%= content_tag :div, class: 'flex items-center justify-center gap-x-2 py-4' do %>
            <%= content_tag :div, class: "flex items-center" do %>
              <%= f.search_field :name,
                value: params[:name],
                autocomplete: 'name',
                placeholder: 'Name...',
                class: 'bg-white flex items-center justify-between p-2 rounded-md font-medium text-sm border border-gray-400 hover:bg-gray-100' %>
            <% end %>

            <%= content_tag :div, class: 'flex items-center' do %>
              <%= f.select :status,
                options_for_select([['Active', true], ['Inactive', false]], params[:status]),
                { include_blank: 'Any Status' },
                class: 'bg-white flex items-center justify-between p-2 rounded-md font-medium text-sm border border-gray-400 hover:bg-gray-100' %>
            <% end %>

            <%= content_tag :div, class: 'flex items-center' do %>
              <%= f.select :sort,
                options_for_select([['Name', 'name'], ['Updated At', 'updated_at']], params[:sort]),
                { include_blank: 'Sort By' },
                class: 'bg-white flex items-center justify-between p-2 rounded-md font-medium text-sm border border-gray-400 hover:bg-gray-100' %>
            <% end %>

            <%= content_tag :div, class: 'flex items-center' do %>
              <%= f.select :order,
                options_for_select([['Ascending', 'asc'], ['Descending', 'desc']], params[:order]),
                { include_blank: 'Order' },
                class: 'bg-white flex items-center justify-between p-2 rounded-md font-medium text-sm border border-gray-400 hover:bg-gray-100' %>
            <% end %>
          <% end %>
        <% end %>

        <%= content_tag :div, class: 'self-center' do %>
          <%== pagy_nav(@pagy) %>
        <% end %>
      <% end %>

      <%= turbo_frame_tag 'galleries_results' do %>
        <%= content_tag :div, class: 'grid grid-cols-1 gap-4' do %>
          <% @galleries.each do |gallery| %>
            <%= content_tag :div, id: "#{dom_id(gallery)}", class: 'bg-white p-5 rounded-xl border border-gray-300 hover:shadow-lg transition-shadow duration-200' do %>
              <%= content_tag :div, class: 'grid grid-cols-1' do %>
                <%= content_tag :div, class: 'flex gap-x-2 items-center' do %>
                  <%= content_tag :h1, gallery.name, class: 'text-xl font-bold mb-1' %>
                  <%= gallery_badge_status(gallery) %>
                <% end %>

                <%= content_tag :p, gallery.description, class: 'text-sm text-gray-500' %>
              <% end %>

              <%= content_tag :div, class: 'flex justify-around py-4' do %>
                <%= content_tag :div, class: 'flex flex-col' do %>
                  <%= content_tag :span, 'Collections', class: 'font-semibold' %>
                  <%= content_tag :span, gallery.collections.size %>
                <% end %>
                <%= content_tag :div, class: 'flex flex-col' do %>
                  <%= content_tag :span, 'Photos', class: 'font-semibold' %>
                  <%= content_tag :span, gallery.collections.sum { |collection| collection.photos.size }  %>
                <% end %>
                <%= content_tag :div, class: 'flex flex-col' do %>
                  <%= content_tag :span, 'Last Updated', class: 'font-semibold' %>
                  <%= content_tag :span, gallery.updated_at.strftime("%b %-d, %Y") %>
                <% end %>
              <% end %>

              <%= content_tag :div, class: 'flex justify-between' do %>
                <%= content_tag :div do %>
                  <%= link_to new_store_gallery_path, class: 'bg-white flex items-center justify-between px-4 py-2 rounded-md font-medium text-sm border border-gray-400 hover:bg-gray-100' do %>
                    <%= icon 'chevron-right' %>
                    <%= content_tag :span, 'View Collections' %>
                  <% end %>
                <% end %>

                <%= content_tag :div, class: 'flex gap-x-2' do %>
                  <%= link_to 'Edit Gallery',
                    edit_store_gallery_path(@store.slug, gallery.id),
                    class: 'bg-white flex items-center justify-between px-4 py-2 rounded-md font-medium text-sm border border-gray-400 hover:bg-gray-100' %>
                  <%= button_to 'Delete',
                    store_gallery_path(@store.slug, gallery.id),
                    method: :delete,
                    data: { turbo_confirm: 'Are you sure you want to delete this gallery?' },
                    class: 'bg-red-100 border border-red-500 flex items-center justify-between px-6 py-2.5 rounded-md font-medium text-sm border hover:bg-red-200 cursor-pointer' %>
                <% end %>
              <% end %>
            <% end %>
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  <% end %>
<% end %>
